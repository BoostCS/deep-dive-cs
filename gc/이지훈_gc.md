## Garbage Collector
> ë™ì ìœ¼ë¡œ í• ë‹¹ëœ ë©”ëª¨ë¦¬ ì˜ì—­ ì¤‘ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì˜ì—­ì„ íƒì§€í•˜ì—¬ í•´ì œí•˜ëŠ” ê¸°ëŠ¥
- ë™ì ìœ¼ë¡œ í• ë‹¹í–ˆë˜ ë©”ëª¨ë¦¬ -> í™ ë©”ëª¨ë¦¬
- ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì˜ì—­           -> ì–´ë–¤ ë³€ìˆ˜ë„ ê°€ë¦¬í‚¤ì§€ ì•ŠëŠ” ì˜ì—­

### â“GCê°€ ì™œ í•„ìš”í• ê¹Œ?
- ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€
- í•´ì œëœ ë©”ëª¨ë¦¬ ì ‘ê·¼ ë°©ì§€
- í•´ì œí•œ ë©”ëª¨ë¦¬ ë˜ í•´ì œ ë°©ì§€ -> ì´ì¤‘ í•´ì œ ë°©ì§€

==ê·¸ëŸ¼ GCì—ëŠ” ë‹¨ì ì´ ì—†ëŠ”ê±¸ê¹Œ?==
> ì–´ëŠ í”„ë¡œê·¸ë¨ì´ë“  ë‹¨ì ì€ ì¡´ì¬í•  ìˆ˜ ë°–ì— ì—†ë‹¤.
- GC ì‘ì—…ì€ ìˆœìˆ˜ ì˜¤ë²„í—¤ë“œ
	- ë©”ëª¨ë¦¬ ì˜ì—­ì´ í•´ì œì˜ ëŒ€ìƒì´ ë ì§€ ê²€ì‚¬í•˜ê³  í•´ì œí•˜ëŠ” ì¼ì€ í”„ë¡œê·¸ë¨ì´ í•´ì•¼ í•  ì¼ì„ ëª»í•˜ë„ë¡ ë°©í•´í•˜ê¸° ë•Œë¬¸ì´ë‹¤.
- ê°œë°œìëŠ” GCê°€ ë©”ëª¨ë¦¬ë¥¼ í•´ì œí•˜ëŠ”ì§€ ëª¨ë¥¸ë‹¤.
**JVMì—ì„œ GCê°€ ì•Œì•„ì„œ ë©”ëª¨ë¦¬ ì˜ì—­ì„ í•´ì œ í•´ì¤€ë‹¤ê³  í•´ì„œ ìš°ë¦¬ê°€ ë©”ëª¨ë¦¬ë¥¼ ì‹ ê²½ì“°ì§€ ì•Šì•„ë„ ë˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤!**

## ğŸ§ GC ì•Œê³ ë¦¬ì¦˜
> Reference Countingê³¼ Mark And Sweepì— ëŒ€í•´ì„œë§Œ ì •ë¦¬

### Reference Counting
- ì°¸ì¡°íšŸìˆ˜ == 0 ì€ GCì˜ ëŒ€ìƒì´ ëœë‹¤.
- ì°¸ì¡°íšŸìˆ˜ >= 1 ì€ GCì˜ ëŒ€ìƒì´ ë˜ì§€ ì•ŠëŠ”ë‹¤.

![ReferenceCounting1](https://user-images.githubusercontent.com/53300830/208671478-eb8a8f67-b96e-4687-b32e-15db498582e9.png)

- ìŠ¤íƒë³€ìˆ˜ ì „ì—­ë³€ìˆ˜ ë“± heap ì˜ì—­ ì°¸ì¡°ë¥¼ ë‹´ì€ ë³€ìˆ˜ë¼ê³  ìƒê°í•˜ë©´ í¸í•˜ë‹¤

![ReferenceCounting2](https://user-images.githubusercontent.com/53300830/208671528-85f6dc85-f215-40b7-9e5d-67ed18fa78c9.png)

- Heap ì˜ì—­ì— ì„ ì–¸ëœ ê°ì²´ë“¤ì´ ê°ê° reference countë¼ëŠ” ë³„ë„ ìˆ«ìë¥¼ ê°€ì§€ê³  ìˆë‹¤ê³  ìƒê°í•˜ë©´ ì´í›„ GCì— ëŒ€í•´ì„œ ë” í¸í•˜ê²Œ ì´í•´ê°€ ê°€ëŠ¥í•˜ë‹¤!
- ì—¬ê¸°ì„œ reference countëŠ” ëª‡ ê°€ì§€ ë°©ë²•ìœ¼ë¡œ í•´ë‹¹ ê°ì²´ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ”ì§€ë¥¼ ëœ»í•œë‹¤.
- í•˜ë‚˜ë„ ì—†ë‹¤ë©´ 0ì´ ë˜ê³ , GCì— ëŒ€ìƒì´ ë˜ëŠ” ê²ƒì´ë‹¤.

![ReferenceCounting3](https://user-images.githubusercontent.com/53300830/208671573-e50a12b0-efbc-4172-bb76-a755ab08cf7f.png)


- í•˜ì§€ë§Œ ì´ëŸ° ìƒí™©ì´ë©´ ì–´ë–»ê²Œ ë ê¹Œ? ì„œë¡œ ì°¸ì¡°ë¥¼ í•˜ê³  ìˆëŠ” ìˆœí™˜êµ¬ì¡°ì¸ ìƒíƒœì´ë‹¤.
- Root Space ì—ì„œì˜ ì ‘ê·¼ì„ ëª¨ë‘ ëŠì—ˆì§€ë§Œ ë„¤ëª¨ ì•ˆì—ëŠ” ì„œë¡œê°€ ì°¸ì¡°ë¥¼ í•˜ê³  ìˆê¸° ë•Œë¬¸ì— Reference CountëŠ” 1ì´ ëœë‹¤.
**ì‚¬ìš©í•˜ì§€ëŠ” ì•Šì§€ë§Œ GCì—ì„œëŠ” ì–˜ ì‚¬ìš© ì¤‘ì´ì•¼! í•˜ëŠ” ê²ƒìœ¼ë¡œ ì˜¤í•´ë¥¼ í•˜ê³  ìˆê¸° ë•Œë¬¸ì— Memory Leak ê°€ ìƒê¸°ê²Œ ë©ë‹ˆë‹¤.**

### Mark-Sweep
> Reference Countingì˜ ìˆœí™˜ ì°¸ì¡° ë¬¸ì œë¥¼ í•´ê²°í•´ì¤€ë‹¤.
> ë£¨íŠ¸ì—ì„œë¶€í„° í•´ë‹¹ ê°ì²´ì— ì ‘ê·¼ì´ ê°€ëŠ¥í•œì§€ ë¶ˆê°€ëŠ¥í•œì§€ê°€ ê¸°ì¤€ì´ ëœë‹¤.

![MarkAndSweep1](https://user-images.githubusercontent.com/53300830/208671673-8ca96286-46d8-4c62-86ea-2e242acde8fc.png)
- ë£¨íŠ¸ë¶€í„° ê·¸ë˜í”„ë¥¼ ìˆœíšŒí•´ì„œ ì—°ê²°ëœ ê°ì²´ë“¤ì„ ì°¾ì•„ë‚´ê³ , ì—°ê²°ë˜ì§€ ì•Šì€ ê°ì²´ë“¤ì€ ì§€ìš°ê²Œ ëœë‹¤.
- ë£¨íŠ¸ë¡œë¶€í„° ì—°ê²°ëœ ê°ì²´ëŠ” : Reachable
- ë£¨íŠ¸ë¡œë¶€í„° ì—°ê²°ì´ ëŠê¸´ ê°ì²´ëŠ” : UnReachable

![MarkAndSweep2](https://user-images.githubusercontent.com/53300830/208674028-b82ea6fd-0d2c-464d-b417-caeefeb11f64.png)
- ë¶„ì‚°ë¼ ìˆë˜ ë©”ëª¨ë¦¬ê°€ ì •ë¦¬ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.
- ì´ëŸ° ë©”ëª¨ë¦¬ íŒŒí¸í™”ë¥¼ ë§‰ëŠ” ê²ƒì„ Compactionì´ë¼ê³  í•œë‹¤.
- Javaì™€ JS ë‘˜ ë‹¤ ì´ ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤.

==Mark-Sweep ì—ëŠ” ë‹¨ì ì´ ì—†ëŠ”ê±¸ê¹Œ?==
> ì–¸ì œë‚˜ ê·¸ë ‡ë“¯ ì¥ì ì´ ìˆìœ¼ë©´ ë‹¨ì ì´ ìˆë‹¤.
- ì˜ë„ì ìœ¼ë¡œ GCë¥¼ ì‹¤í–‰ì‹œì¼œì•¼ í•œë‹¤. (Reference Counting ê³¼ ë°˜ëŒ€ì´ë‹¤.)
- ì–´í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ê³¼ GC ì‹¤í–‰ì´ ë³‘í–‰ëœë‹¤
**ì´ì²˜ëŸ¼ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‚¬ìš©ì„±ì„ ìœ ì§€í•˜ë©´ì„œ íš¨ìœ¨ì ì´ê²Œ GCë¥¼ ì‹¤í–‰ì‹œí‚¤ëŠ” ê²ƒì€ ì—„ì²­ë‚˜ê²Œ ì–´ë ¤ìš´ ìµœì í™” ì‘ì—…ì´ë‹¤.**

### Mark Sweep ì˜ˆì‹œ

**í¬ê²Œ Young Generationê³¼ Old Generationìœ¼ë¡œ ë‚˜ë‰˜ì–´ì§„ë‹¤. í¸ì˜ìƒ Y Gë¡œ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.**

-   Yì—ì„œ ë°œìƒí•˜ëŠ” GCëŠ” `minor gc`
-   Oì—ì„œ ë°œìƒí•˜ëŠ” GCëŠ” `major gc`
    -   ì„¸ ì˜ì—­ìœ¼ë¡œ ë‚˜ëˆ ì–´ì§„ë‹¤.
    -   Edenì€ ìƒˆë¡­ê²Œ ìƒì„±ëœ ê°ì²´
    -   `Survival` ì€ `minor gc` ë¡œ ë¶€í„° ì‚´ì•„ ë‚¨ì€ ê°ì²´ë“¤ì´ ì¡´ì¬í•œë‹¤.
        -   ì´ë•Œ ì‹ ê¸°í•œ ê·œì¹™ì´ ìˆë‹¤. `survival0` í˜¹ì€ `survival1` ì€ ë¹„ì–´ìˆì–´ì•¼ë§Œí•œë‹¤.

![Mark_Sweep_1](https://user-images.githubusercontent.com/53300830/208671613-952fca61-066e-4d93-8f18-f5f8c177d18e.png)
> ìœ„ ì´ˆë¡ìƒ‰ì€ ë£¨íŠ¸ë¡œë¶€í„° Reachable(ì‚´ì•„ë‚¨ì„ ê°ì²´ë“¤) ë…¸ë€ìƒ‰ì€ UnReachable(í•´ì œë  ê°ì²´ë“¤)ì´ë¼ íŒë‹¨ëœ ê°ì²´ì…ë‹ˆë‹¤.

-   ì´ë ‡ê²Œ Reachableì´ë¼ íŒë‹¨ëœ ê°ì²´ëŠ” Survivalë¡œ ì˜®ê²¨ì§€ê²Œ ë©ë‹ˆë‹¤.


![Mark_Sweep_2](https://user-images.githubusercontent.com/53300830/208671620-ed4b48a7-7bd9-46d5-b28f-9e237ab6a6de.png)
-   Survival 0ìœ¼ë¡œ ì˜®ê²¨ì§„ ê°ì²´ë“¤ì˜ ìˆ«ìê°€ 1ë¡œ ë°”ë€Œê²Œ ëœë‹¤. (ê·¸ë¦¬ê³  ë…¸ë€ìƒ‰ ê°ì²´ë“¤ì„ ì°¸ì¡°ê°€ í•´ì œë©ë‹ˆë‹¤.)
-   í•´ë‹¹ ìˆ«ìëŠ” `age-bit` ë¼ê³  í•œë‹¤. `major gc` ì—ì„œ ì‚´ì•„ë‚¨ì„ë•Œë§ˆë‹¤ `+1` ì´ ëœë‹¤.


![Mark_Sweep_3](https://user-images.githubusercontent.com/53300830/208671622-5a25b1f6-e50a-4e68-9f96-15a8a6a6f57a.png)
- ì‹œê°„ì´ í˜ëŸ¬ Edenì— ë˜ ê½‰ì°¨ë©´ Reachableì´ë¼ íŒë‹¨ëœ ê°ì²´ë“¤ì´ Survival1ë¡œ ì˜®ê²¨ì§€ê²Œ ëœë‹¤.


![Mark_Sweep_5](https://user-images.githubusercontent.com/53300830/208671624-ffd03486-c908-4e57-b9a3-4f646e0d7ddd.png)
-   ì´ëŸ¬í•œ ê³¼ì • ì†ì—ì„œ `age-bit` ê°€ 3ì´ ëœ ê°ì²´ê°€ ìˆë‹¤ê³  ê°€ì •í•˜ê² ìŠµë‹ˆë‹¤.
-   ì¼ì • ìˆ˜ì¤€ì˜ `age-bit` ë¥¼ ë„˜ì–´ê°€ë©´ ì˜¤ë˜ë„ë¡ ì°¸ì¡°ë  ê°ì²´ë¼ëŠ” ê²ƒìœ¼ë¡œ íŒë‹¨í•˜ì—¬ `Old Generation`ìœ¼ë¡œ ì˜®ê²¨ê°€ê²Œ ë©ë‹ˆë‹¤. ì´ê²ƒì„ `promotion` ì´ë¼ê³  ë¶€ë¥¸ë‹¤.
    -   Java 8ê¸°ì¤€ìœ¼ë¡œëŠ” `age-bit`ê°€ 15ê°€ ë˜ë©´ `promotion`ì´ ì§„í–‰ì´ ëœë‹¤.

==ì´ëŸ¬í•œ ê³¼ì •ì†ì—ì„œ Old Generationë„ ì–¸ì  ê°€ëŠ” ê½‰ì°¨ê²Œ ëœë‹¤.==
-   ì´ë•Œ `major GC`ê°€ ë°œìƒí•œë‹¤!
-   ë˜‘ê°™ì´ Mark And Sweep ë°©ì‹ì„ í†µí•´ í•„ìš” ì—†ëŠ” ë©”ëª¨ë¦¬ë¥¼ ë¹„ìš°ê²Œ ëœë‹¤.
    -   ë‹¹ì—°í•˜ê²Œë„ í¬ê¸°ê°€ í¬ê¸° ë•Œë¬¸ì— `minor gc` ë³´ë‹¤ ì˜¤ë˜ ê±¸ë¦°ë‹¤!

## ğŸ˜€ Old ì˜ì—­ì— ëŒ€í•œ GC
> Old ì˜ì—­ì€ ê¸°ë³¸ì ìœ¼ë¡œ ë°ì´í„°ê°€ ê°€ë“ ì°¨ë©´ GCë¥¼ ì‹¤í–‰í•œë‹¤.
> ì´ë•Œ ë°©ì‹ì— ë”°ë¼ì„œ ì ˆì°¨ê°€ ë‹¬ë¼ì§€ë¯€ë¡œ, ì–´ë–¤ GCê°€ ìˆëŠ”ì§€ ì •ë¦¬ë¥¼ í•´ë³´ì!
- Serial GC
- Parallel GC
- Parallel Old GC(Parallel Compacting GC)
- Concurrent Mark & Sweep GC (CMS)
- G1 (Garbage First) GC

==ìš´ì˜ ì„œë²„ì—ì„œ ì ˆëŒ€ ì‚¬ìš©í•˜ë©´ ì•ˆë˜ëŠ” ë°©ì‹ì€ Serial GCì´ë‹¤.==
- Serial GCëŠ” ë°ìŠ¤í¬í†± CPU ì½”ì–´ê°€ í•˜ë‚˜ë§Œ ìˆì„ ë•Œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œë§Œë“  ë°©ì‹ì´ë‹¤.
- Serial GCë¥¼ ì‚¬ìš©í•˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„±ëŠ¥ì´ ë§ì´ ë–¨ì–´ì§„ë‹¤.

### Serial GC
>Young ì˜ì—­ì—ì„œì˜ GCëŠ” ì• ì ˆì—ì„œ ì„¤ëª…í•œ ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤. 
- Old ì˜ì—­ì˜ GCëŠ” mark-sweep-compact ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•œë‹¤.
- ì²« ë‹¨ê³„ëŠ” Old ì˜ì—­ì— ì‚´ì•„ ìˆëŠ” ê°ì²´ë¥¼ ì‹ë³„í•˜ëŠ” ê²ƒì´ë‹¤.
- ê·¸ ë‹¤ìŒì— í™ì˜ ì• ë¶€ë¶„ë¶€í„° í™•ì¸í•˜ì—¬ ì‚´ì•„ìˆëŠ” ê²ƒë§Œ ë‚¨ê¸´ë‹¤.
- ë§ˆì§€ë§‰ ë‹¨ê³„ì—ì„œëŠ” ê° ê°ì²´ë“¤ì´ ì—°ì†ë˜ê²Œ ìŒ“ì´ë„ë¡ í™ì˜ ê°€ì¥ ì• ë¶€ë¶„ë¶€í„° ì±„ì›Œì„œ ê°ì²´ê°€ ì¡´ì¬í•˜ëŠ” ë¶€ë¶„ê³¼ ê°ì²´ê°€ ì—†ëŠ” ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆˆë‹¤. (Compaction)

### Parallel GC
>Parallel GCëŠ” Serial GCì™€ ê¸°ë³¸ì ì¸ ì•Œê³ ë¦¬ì¦˜ì€ ê°™ë‹¤. 
- ê·¸ëŸ¬ë‚˜ Serail GCëŠ” GCë¥¼ ì²˜ë¦¬í•˜ëŠ” ìŠ¤ë ˆë“œê°€ í•˜ë‚˜ì¸ ê²ƒì— ë¹„í•´, Parallel GCëŠ” GCë¥¼ ì²˜ë¦¬í•˜ëŠ” ìŠ¤ë ˆë“œê°€ ì—¬ëŸ¬ ê°œì´ë‹¤.
- ê·¸ë ‡ê¸° ë•Œë¬¸ì— Serail GC ë³´ë‹¤ ë¹ ë¥´ê²Œ ê°ì²´ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.
- Parallel GCëŠ” ë©”ëª¨ë¦¬ê°€ ì¶©ë¶„í•˜ê³  ì½”ì–´ì˜ ê°œìˆ˜ê°€ ë§ì„ ë•Œ ìœ ë¦¬í•˜ë‹¤.

![SerialVsParallel](https://user-images.githubusercontent.com/53300830/208671860-28f23b6d-8d31-46fc-b009-01795c7a17fe.png)

### Parallel Old GC
> ì•ì„œ ì„¤ëª…í•œ Parallel GCì™€ ë¹„êµí•˜ì—¬ Old ì˜ì—­ì˜ GC ì•Œê³ ë¦¬ì¦˜ë§Œ ë‹¤ë¥´ë‹¤.
- Mark-Summary-Compaction ë‹¨ê³„ë¥¼ ê±°ì¹œë‹¤.
- Summary ë‹¨ê³„ëŠ” GCë¥¼ ìˆ˜í–‰í•œ ì˜ì—­ì— ëŒ€í•´ì„œ ë³„ë„ë¡œ ì‚´ì•„ ìˆëŠ” ê°ì²´ë¥¼ ì‹ë³„í•œë‹¤ëŠ”ì ì—ì„œ Mark-Sweep-Compaction ì•Œê³ ë¦¬ì¦˜ì˜ Sweep ë‹¨ê³„ì™€ ë‹¤ë¥´ë©°, ì•„ì£¼ ì•½ê°„ ë” ë³µì¡í•œ ë‹¨ê³„ë¥¼ ê±°ì¹œë‹¤.

### CMS GC
>ì´ˆê¸° Mark ë‹¨ê³„ì—ì„œëŠ” í´ë˜ìŠ¤ ë¡œë”ì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ ê°ì²´ ì¤‘ ì‚´ì•„ ìˆëŠ” ê°ì²´ë§Œ ì°¾ëŠ” ê²ƒìœ¼ë¡œ ëë‚¸ë‹¤. 
>ë”°ë¼ì„œ ë©ˆì¶”ëŠ” ì‹œê°„ì´ ë§¤ìš° ì§§ë‹¤.
- Concurrent Mark ë‹¨ê³„ì—ì„œëŠ” ë°©ê¸ˆ ì‚´ì•„ìˆë‹¤ê³  í™•ì¸í•œ ê°ì²´ì—ì„œ ì°¸ì¡°í•˜ê³  ìˆëŠ” ê°ì²´ë“¤ì„ ë”°ë¼ê°€ë©´ì„œ í™•ì¸í•œë‹¤.
	- ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ ì‹¤í–‰ì¤‘ì¸ ìƒíƒœì—ì„œ ë™ì‹œì— ì§„í–‰ëœë‹¤ëŠ” ê²ƒì´ë‹¤.
- Remark ë‹¨ê³„ì—ì„œëŠ” Concurrent Mark ë‹¨ê³„ì—ì„œ ìƒˆë¡œ ì¶”ê°€ë˜ê±°ë‚˜ ì°¸ì¡°ê°€ ëŠê¸´ ê°ì²´ë¥¼ í™•ì¸í•œë‹¤.
- Concurrent Sweep ë‹¨ê³„ì—ì„œëŠ” ì“°ë ˆê¸°ë¥¼ ì •ë¦¬í•˜ëŠ” ì‘ì—…ì„ ì‹¤í–‰í•œë‹¤.
	- ì´ ì‘ì—…ë„ ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ ì‹¤í–‰ë˜ê³  ìˆëŠ” ìƒí™©ì—ì„œ ì§„í–‰í•œë‹¤.

![CMS](https://user-images.githubusercontent.com/53300830/208671907-bf7a495a-b7ee-4a58-bf36-9f0603380b16.png)

==í•˜ì§€ë§Œ í™•ì‹¤í•œ ë‹¨ì ì´ ì¡´ì¬í•œë‹¤.==
- ë‹¤ë¥¸ GC ë°©ì‹ë³´ë‹¤ ë©”ëª¨ë¦¬ì™€ CPUë¥¼ ë” ë§ì´ ì‚¬ìš©í•œë‹¤.
- Compcation ë‹¨ê³„ê°€ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µë˜ì§€ ì•ŠëŠ”ë‹¤.

> ë¬¸ì œê°€ ë§ì•„ì„œ ê·¸ëŸ°ì§€ Java9ë¶€í„°ëŠ” Deprecated ëê³ , Java 14ë²„ì „ë¶€í„°ëŠ” ì‚¬ìš©ì´ ì¤‘ë‹¨ëë‹¤.

### G1 GC
> G1 GCë¥¼ ì´í•´í•˜ë ¤ë©´ ì§€ê¸ˆê¹Œì§€ ì´í•´í•˜ê³  ìˆë˜ Young ì˜ì—­ê³¼ Old ì˜ì—­ì„ ìŠì–´ë²„ë ¤ì•¼ í•œë‹¤.
- G1 GCëŠ” ê°œë…ì ìœ¼ë¡œ ê·¸ë“¤ì´ ì¡´ì¬í•˜ë‚˜ ì¼ì • í¬ê¸°ì˜ ë…¼ë¦¬ì  ë‹¨ìœ„ì¸ regionìœ¼ë¡œ êµ¬ë¶„í•˜ê³  ìˆë‹¤.
- Humonogous: Region í¬ê¸°ì˜ 50%ë¥¼ ì´ˆê³¼í•˜ëŠ” í° ê°ì²´ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•œ ê³µê°„
- Available/Unused: ì•„ì§ ì‚¬ìš©ë˜ì§€ ì•Šì€ Region

![G1GC](https://user-images.githubusercontent.com/53300830/208671981-185c3b53-9580-4f2c-ad62-9be304c30933.png)
- í•´ë‹¹ ì˜ì—­ì´ ê½‰ ì°¨ë©´ ë‹¤ë¥¸ ì˜ì—­ì—ì„œ ê°ì²´ë¥¼ í• ë‹¹í•˜ê³  GCë¥¼ ì‹¤í–‰í•œë‹¤.
- ì§€ê¸ˆê¹Œì§€ ì„¤ëª…í•œ Youngì˜ ì„¸ê°€ì§€ ì˜ì—­ì—ì„œ ë°ì´í„°ê°€ Old ì˜ì—­ìœ¼ë¡œ ì´ë™í•˜ëŠ” ë‹¨ê³„ê°€ ì‚¬ë¼ì§„ GC ë°©ì‹ìœ¼ë¡œ ì´í•´í•˜ë©´ ëœë‹¤.

## ğŸ§ G1 GCì— ëŒ€í•´ì„œ ì¡°ê¸ˆë§Œ ë” ê¹Šê²Œ ë“¤ì–´ê°€ë³´ì!

### G1 GCì˜ Cycle
![G1GCá„‹á…´Cycle](https://user-images.githubusercontent.com/53300830/208672033-73fc111c-6715-4ff8-911e-5e50624b7b00.png)

- Young-Onlyì™€ Space Reclamationë¥¼ ë°˜ë³µí•œë‹¤.
- ì‚¬ì´í´ ì¤‘ ëª¨ë“  ì›ì€ STWê°€ ë°œìƒí•œ ê²ƒì„ ë‚˜íƒ€ë‚¸ ê²ƒì´ê³ , ì›ì˜ í¬ê¸°ì— ë”°ë¼ STW ì†Œìš” ì‹œê°„ì´ ë‹¬ë¼ì§„ë‹¤ê³  ìƒê°í•˜ë©´ ëœë‹¤!
### Young Only
> Young OnlyëŠ” Minor GCë§Œ ìˆ˜í–‰í•˜ë‹¤ê°€ Old Generation ë¹„ìœ¨ì— ì§€ì •ëœ ê°’ì´ ì´ˆê³¼í•˜ëŠ” ìˆœê°„ Major GCê°€ ìˆ˜í–‰ëœë‹¤.

- Major GCì˜ ì²« ë‹¨ê³„ëŠ” Initial Markì´ë©°, Minor GCì™€ ë™ì‹œì— ìˆ˜í–‰ë˜ë©° ë‘˜ ë‹¤ STWë¥¼ ìˆ˜ë°˜í•œë‹¤.
- ì• í”Œë¦¬ì¼€ì´ì…˜ ìŠ¤ë ˆë“œ, Minor GC, Concurrent Markê°€ ë™ì‹œì— ìˆ˜í–‰ë˜ëŠ”ë° Remarkê°€ ìˆ˜í–‰ë˜ëŠ” ìˆœê°„ ë‹¤ë¥¸ ì‘ì—…ì€ ë©ˆì¶”ê²Œ ëœë‹¤.
	- ê·¸ë˜ì„œ Remarkì— í•´ë‹¹í•˜ëŠ” ì£¼í™©ìƒ‰ ì›ì´ í° ê²ƒì´ë‹¤.
- ê·¸ ì´í›„ Minor GCê°€ ìˆ˜í–‰ë˜ë‹¤ê°€ Major GCì˜ Cleanupì´ ë°œìƒí•œë‹¤.

### Space Reclamation
> Young Onlyê°€ ëë‚˜ê³  Space Reclamationì´ ì‹œì‘ëœë‹¤.

- í•´ë‹¹ Phaseì—ì„œëŠ” Mixed GCê°€ ìˆ˜í–‰ëœë‹¤.
	- Mark ë‹¨ê³„ê°€ ì—†ì–´ì„œ STW(Stop The World) ë¹ˆë„ê°€ Young Only Phaseì— ë¹„í•´ ì¤„ì–´ë“ ë‹¤.
	- Space Reclamationì´ ëë‚˜ë©´ ë‹¤ì‹œ Young Onlyë¡œ ëŒì•„ê°€ì„œ Minor GCë¥¼ ì‹¤í–‰í•œë‹¤.

### G1 GC Minor GC(Young Generation) ë™ì‘ ê³¼ì •
![G1_MInor_1](https://user-images.githubusercontent.com/53300830/208672082-ce974ce0-13a8-42eb-8139-237e4aac343c.png)
- ì—°ì†ë˜ì§€ ì•Šì€ ë©”ëª¨ë¦¬ ê³µê°„ì— Young Generationì´ Region ë‹¨ìœ„ë¡œ ë©”ëª¨ë¦¬ì— í• ë‹¹ëœë‹¤.

![G1_MInor_2](https://user-images.githubusercontent.com/53300830/208672091-e73e2bad-a5d9-4129-90b6-494258feef9f.png)
- Young Generationì— ìˆëŠ” ìœ íš¨ ê°ì²´ë¥¼ Survivor Regionì´ë‚˜ Old Generationìœ¼ë¡œ copy or moveí•œë‹¤.
- ì´ ë‹¨ê³„ì—ì„œ STWê°€ ë°œìƒí•˜ê³ , Eden Regionê³¼ Survivor Regionì˜ í¬ê¸°ëŠ” Minor GCë¥¼ ìœ„í•´ ë‹¤ì‹œ ê³„ì‚°ëœë‹¤.

![G1_MInor_3](https://user-images.githubusercontent.com/53300830/208672096-ef5fd112-182c-4bc7-9783-52ac16286572.png)

- Minor GCë¥¼ ëª¨ë‘ ë§ˆì¹œ í›„ì˜ ëª¨ìŠµì´ë‹¤.
- ì²­ë¡ìƒ‰ ì˜ì—­ì€ Eden ì˜ì—­ì—ì„œ Survivor ì˜ì—­ìœ¼ë¡œ ì´ë™í•˜ê±°ë‚˜ Survivorì—ì„œ Survivorë¡œ ì´ë™í•œ ê²ƒì„ ëœ»í•œë‹¤.

### G1 GC Major GC(Old GC) ë™ì‘ ê³¼ì •
> Minor GCì™€ ì›ë¦¬ê°€ ë¹„ìŠ·í•˜ë‚˜ ë©€í‹° ìŠ¤ë ˆë“œì—ì„œ ë³‘ë ¬ë¡œ ë™ì‘í•œë‹¤.

![G1_Major_1 1](https://user-images.githubusercontent.com/53300830/208673430-7b9c5bf2-939f-4746-ab2b-6268b4338256.png)
- Initial Mark ë‹¨ê³„ëŠ” Old Regionì— ì¡´ì¬í•˜ëŠ” ê°ì²´ë“¤ì´ ì°¸ì¡°í•˜ëŠ” Survivor Regionì´ ìˆëŠ”ì§€ íŒŒì•… í›„ Survivor Regionì— ë§ˆí‚¹í•˜ëŠ” ë‹¨ê³„ì´ë‹¤.
- Survivor Regionì— ì˜ì¡´í•˜ê¸° ë•Œë¬¸ì— Survivor Regionì€ ê¹”ë”í•œ ìƒíƒœì—¬ì•¼ í•˜ê³ , Survivor Regionì´ ê¹”ë”í•˜ë ¤ë©´ Minor GCê°€ ì „ë¶€ ëë‚œ ìƒíƒœì—¬ì•¼ í•œë‹¤.
- ë”°ë¼ì„œ Inital MarkëŠ” Minor GCì— ì˜ì¡´ì ì´ë©°, STWë¥¼ ë°œìƒí•œë‹¤.
- Inital Mark ì´í›„ Root Region Scan ë‹¨ê³„ê°€ ìˆ˜í–‰ëœë‹¤.
- ë§ˆí‚¹ëœ Survivor Regionì—ì„œ Old Regionì— ëŒ€í•´ ì°¸ì¡°í•˜ê³  ìˆëŠ” ê°ì²´ë¥¼ ë§ˆí‚¹í•œë‹¤.
- ë©€í‹° ìŠ¤ë ˆë“œë¡œ ë™ì‘í•˜ë©° ë‹¤ìŒ Minor GCê°€ ë°œìƒí•˜ê¸° ì „ì— ë™ì‘ì„ ì™„ë£Œí•œë‹¤.


![G1_Major_2 1](https://user-images.githubusercontent.com/53300830/208673547-9cdbb1a9-684c-41b2-bf2a-261e904ba983.png)
- Concurrent Marking ë‹¨ê³„ì—ì„œëŠ” Old Generation ë‚´ì— ìƒì¡´í•´ ìˆëŠ” ëª¨ë“  ê°ì²´ë¥¼ ë§ˆí‚¹í•œë‹¤.
- STWê°€ ë°œìƒí•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ ìŠ¤ë ˆë“œì™€ ë™ì‹œì— ë™ì‘í•˜ê³ , Minor GCì™€ ê°™ì´ ì§„í–‰í•˜ë¯€ë¡œ Minor GCì— ì˜í•´ ì¤‘ë‹¨ë  ìˆ˜ ìˆë‹¤.
- ì‚¬ì§„ì—ì„œ X í‘œì‹œëœ Regionì€ ëª¨ë“  ê°ì²´ê°€ Garbage ìƒíƒœì¸ ì˜ì—­ì´ë‹¤.


![G1_Major_3 1](https://user-images.githubusercontent.com/53300830/208673666-5ff68c55-0dfa-46f6-b9c5-de6f074de1e8.png)
- Remark ë‹¨ê³„ëŠ” Concurrent Mark ë‹¨ê³„ì—ì„œ Xí‘œì‹œëœ ì˜ì—­ì„ íšŒìˆ˜í•œë‹¤. -> STW ë°œìƒ
	- Mark ë‹¨ê³„ë¥¼ ë§ˆì € ëë‚¸ë‹¤.
	- ì´ë•Œ SATB(Snapshot-At-The-Beginning) ê¸°ë²•ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— CMS GCë³´ë‹¤ ë” ë¹ ë¥´ë‹¤.
	- SATBëŠ” STW ì´í›„ ì‚´ì•„ìˆëŠ” ê°ì²´ì—ë§Œ ë§ˆí‚¹í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ë‹¤.


![G1_Major_4](https://user-images.githubusercontent.com/53300830/208673707-2142f5d1-e8f7-4d79-8ff9-b3b5c00df009.png)
- Copying/Cleanup ë‹¨ê³„ì—ì„œëŠ” STWê°€ ë°œìƒí•˜ë©° Live Ojbectì˜ ë¹„ìœ¨ì´ ë‚®ì€ ì˜ì—­ ìˆœìœ¼ë¡œ ìˆœì°¨ì ìœ¼ë¡œ ìˆ˜ê±°í•´ê°„ë‹¤.
- ë¨¼ì € í•´ë‹¹ ì˜ì—¬ê²Œì„œ Live Objectë¥¼ ë‹¤ë¥¸ ì˜ì—­ìœ¼ë¡œ move or copyí•œ í›„ Grabageë¥¼ ìˆ˜ì§‘í•œë‹¤.
- G1 GCëŠ” ì´ë ‡ê²Œ Garbageì˜ ìˆ˜ì§‘ì„ ìš°ì„ í•´ì„œ ê³„ì†í•˜ë©° ì—¬ìœ  ê³µê°„ì„ ì‹ ì†í•˜ê²Œ í™•ë³´í•´ ë‘”ë‹¤.


![G1_Major_5](https://user-images.githubusercontent.com/53300830/208673743-4056040d-8ef9-4beb-9b94-1fd02beeaf5f.png)
- Major GCê°€ ëë‚œ ì´í›„ Live Objectê°€ ìƒˆë¡œìš´ Regionìœ¼ë¡œ ì´ë™í•˜ê³  ë©”ëª¨ë¦¬ Compactionì´ ì¼ì–´ë‚˜ì„œ ê¹”ë”í•´ì§„ë‹¤.

### Mixed GC
- Young ì˜ì—­ê³¼ Old ì˜ì—­ì˜ Garbageë¥¼ ìˆ˜ì§‘í•œë‹¤. í•œ ë²ˆì— Old ì˜ì—­ì˜ Garbageë¥¼ ìˆ˜ì§‘í•˜ëŠ” ê²ƒì€ ë¹„ìš©ì´ í¬ë¯€ë¡œ Mixed GCëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 8íšŒ ìˆ˜í–‰ëœë‹¤.
- Minor GCì—ì„œ ìˆ˜í–‰í•˜ëŠ” ë‹¨ê³„ì™€ ë™ì¼í•˜ì§€ë§Œ, ì¶”ê°€ë¡œ Old ì˜ì—­ì˜ Garbageë¥¼ ìˆ˜ì§‘í•œë‹¤. ì¦‰, Mixed GCëŠ” Minor GCì™€ Old ì˜ì—­ì˜ GCë¥¼ í˜¼í•©í•œ ê³¼ì •ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤.

## ğŸ“‹ GCê°€ ë©´ì ‘ ì§ˆë¬¸ìœ¼ë¡œ ë“¤ì–´ì˜¨ë‹¤ë©´
- GCê°€ ë¬´ì—‡ì¸ì§€, ì–´ë–¤ ì•Œê³ ë¦¬ì¦˜ì„ ì“°ëŠ”ì§€ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ëŒ€ë‹µì„ í•´ì•¼ í•œë‹¤.
- ê°€ëŠ¥í•˜ë‹¤ë©´ ì§ì ‘ GC ëª¨ë‹ˆí„°ë§ì„ í•´ë³¸ ê²½í—˜ ê¹Œì§€ ë§í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•˜ë‹¤.
	- SCOUTER, Jenifer -> ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ì˜¤í”ˆì†ŒìŠ¤ 
	- ì•ˆë“œë¡œì´ë“œëŠ” Perfettoë¥¼ ì‚¬ìš©í•œë‹¤.
	- dump ë¶„ì„í•´ë³¸ í›„ -> GC ë¶„ì„ë„êµ¬ í•œ ë²ˆì¯¤ì€ í•´ë³´ëŠ”ê²Œ ì¢‹ë‹¤.

> ê°œë°œìëŠ” ìš´ì˜ëŠ¥ë ¥ë„ ì¤‘ìš”í•˜ë‹¤. GCëŠ” ì´ˆë°˜ ì§ˆë¬¸ìœ¼ë¡œë„ ì¶©ë¶„íˆ ê°€ëŠ¥í•˜ë‹¤.
> ì•ˆë“œë¡œì´ë“œ ê°œë°œìê°€ ë°±ì—”ë“œëŠ” ì•„ë‹ˆê¸°ì— ì—„ì²­ ë§ì€ ì§€ì‹ì„ ì›í•˜ì§€ëŠ” ì•Šê² ì§€ë§Œ ì´ì •ë„ ì–¸ê¸‰ì„ í•œë‹¤ë©´ ì´ˆë°˜ì— ì¢‹ì€ ì¸ìƒì„ ì¤„ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

### ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í…ŒìŠ¤íŠ¸

```kotlin
object Util {  
    const val max = 5_000_000  
    private val rt: Runtime = Runtime.getRuntime()  
  
    fun printHeap(idx: Int) {  
        rt.gc()  
        val total = rt.totalMemory() // ë©”ëª¨ë¦¬ ì´ í•©  
        val free = rt.freeMemory() // ì‚¬ìš© ê°€ëŠ¥í•œ ë©”ëª¨ë¦¬  
        val used = total - free // ì‚¬ìš© ì¤‘ì¸ ë©”ëª¨ë¦¬ëŠ” ì „ì²´ì—ì„œ ì‚¬ìš©ê°€ëŠ¥í•œ ë©”ëª¨ë¦¬ë¥¼ ëº€ ê°’  
        println(String.format("%d Heap:%, 8d bytes", idx, used))  
    }  
}

fun main() {  
    Util.printHeap(0)  
  
    val sb = StringBuffer()  
    for (i in 0..Util.max) {  
        sb.append("a")  
    }    
    Util.printHeap(1)  
    Util.printHeap(2)  
  
    /**  
     0 Heap: 457,536 bytes     
     1 Heap: 19,476,416 bytes     
     2 Heap: 19,474,376 bytes     
     */
}
```

```kotlin
/**  
 * ë©”ëª¨ë¦¬ë‹¨ì—ì„œ Stringìœ¼ë¡œ ê°–ê³  ìˆëŠëƒ byte ìƒíƒœë¡œ ê°–ê³  ìˆëŠëƒì— ë”°ë¼ì„œ ë‘ ë°° ì •ë„ ì°¨ì´ê°€ ìˆë‹¤. 
 * íŒŒì¼ì— ë°ì´í„°ë¥¼ ì—‘ì„¸ìŠ¤í•˜ê±°ë‚˜ í•  ë•Œ ì°¸ê³ í• ë§Œí•œ ìë£Œì´ë‹¤! 
 * */
fun main() {  
    Util.printHeap(0)  
  
    var sb: StringBuffer? = StringBuffer(Util.max)  
    for (i in 0 until Util.max) {  
        sb?.append("a")  
    }    
    val b = sb.toString().toByteArray()  
    sb = null // StringBuffer null ì²˜ë¦¬í•´ì„œ gcì—ì„œ ë‚ ë¼ê°€ê²Œ ì„¤ì •  
    Util.printHeap(1)  
    Util.printHeap(2)  
  
    /**  
     0 Heap: 432,120 bytes     
     1 Heap: 5,601,936 bytes     
     2 Heap: 5,599,440 bytes     
     */
}
```



### ì§ˆë¬¸ ì˜ˆì‹œ
- GCê°€ ë¬´ì—‡ì´ê³  ì¥ë‹¨ì ì€ ì–´ë–»ê²Œ ë˜ëŠ”ì§€?
- GC ì•Œê³ ë¦¬ì¦˜ì€ ì–´ë–¤ê²Œ ìˆëŠ”ì§€
- GCì˜ Survivorì´ ì™œ ë‘ ê°œì¸ì§€
- Mark-Sweep ë°©ì‹ì—ì„œ GCê°€ ì‹¤í–‰ë˜ëŠ” íƒ€ì´ë°ì€ ì–¸ì œì¸ì§€
- GCì˜ ì‹¤í–‰ ë°©ì‹ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”
- G1 GCê°€ ë¬´ì—‡ì´ê³  ì¥ë‹¨ì ì´ ì–´ë–¤ê²Œ ìˆë‚˜?
- G1 GCì˜ Heap êµ¬ì¡°ë¥¼ ì„¤ëª…í•´ì£¼ì„¸ìš”.
- G1 GCì˜ ë™ì‘ ê³¼ì •ì„ ì„¤ëª…í•˜ë¼.

### ì°¸ê³  ìë£Œ 
https://rebelsky.cs.grinnell.edu/Courses/CS302/99S/Presentations/GC/
https://d2.naver.com/helloworld/1329
https://d2.naver.com/helloworld/37111
https://perfectacle.github.io/2019/05/11/jvm-gc-advanced/
https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/cms.html
https://steady-coding.tistory.com/591
